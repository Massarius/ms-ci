# Environments

The current directory hold the effective configurations for Production and Development environments, called **prod** and **env**, respectively.

> **Disclaimer**: at the moment of writing, none of the environments can be assumed to achieve a complete configuration. This is reflected in the first row of the table below, reading 'fully working'.

In addition to prod and dev, other environments are also being tested. These are `minimal-prod` and `minimal-prod-module`. 

These last two environments were created due to configuration issues generated by the original environments. Both of these are currently being tested, replicating the minimal configuration provided in: [source 1](https://cloud.google.com/composer/docs/composer-2/create-environments#gcloud_1) and [source 2](https://cloud.google.com/composer/docs/composer-2/terraform-create-environments).

These is the state of the current repositories, updated in date 19/8/2022:

| Traits | *minimal-prod* | *minimal-prod-module* | dev | prod |
| :--- | :---: | :---: | :---: | :---: |
| Fully Working | :x: | :white_check_mark: |:x: |:x: |
| Experimental | :white_check_mark: | :white_check_mark: | :x: | :x: |
| Shared Files | | | :white_check_mark: | :white_check_mark: |
| Meant for deployment | :x: | :x: | :white_check_mark: | :white_check_mark: |
| VM configuration | :x: | :x: | :white_check_mark: | :white_check_mark: |

### Explanation

**Experimental**: minimal configurations allow us to refine the scope of the problematic parameters to a few components. Without them, is a lot harder to understand how to get terraform to work.

**Shared Files**: these reflect the presence of symlinks (or [symbolic links](https://en.wikipedia.org/wiki/Symbolic_link)) targeting a shared directory). These terraform files specify resources to be deployed onto dev and prod alike. These are:
  
- main.tf 
- outputs.tf
- providers.tf
- variables.tf

Each environment directory also contains files called `terraform.tfvars` overriding the default values specified in `varibales.tf`, wherever it is necessary. 

The fields **meant for deployment** and **VM configuration** are specifying aspects of each configuration which could not be fully tested. 

Each configuration should be worked on without touching other configurations. This is because the state-tflock file is synced with the GCP storage bucket in the GC Project. Once one configuration is tried, we can continue 

## Minimal configurations

This can be run by cd'ing in each directory and running `terraform apply`. 

In the last few days of my employment at MS, I will focus on the minimal-prod-module to configure our DevOps structure. 

