# Environments

The current directory hold the effective configurations for Production and Development environments, called **prod** and **env**, respectively.


In addition to prod and dev, other environments are also being tested. These are `minimal-prod` and `minimal-prod-module`. 

These last two environments were created due to configuration issues generated by the original environments. Both of these are currently being tested, replicating the minimal configuration provided in: [source 1](https://cloud.google.com/composer/docs/composer-2/create-environments#gcloud_1) and [source 2](https://cloud.google.com/composer/docs/composer-2/terraform-create-environments).

These is the state of the current repositories, updated in date 19/8/2022:

| Traits | *minimal-prod* | *minimal-prod-module* | dev | prod |
| :--- | :---: | :---: | :---: | :---: |
| Fully Working | :x: | :white_check_mark: |:x: |:x: |
| Experimental | :white_check_mark: | :white_check_mark: | :x: | :x: |
| Shared Files | | | :white_check_mark: | :white_check_mark: |
| Meant for deployment | :x: | :arrow_right: | :white_check_mark: | :white_check_mark: |
| VM configuration | :x: | :white_check_mark: | :white_check_mark: | :white_check_mark: |

### Explanation

**Experimental**: minimal configurations allow us to refine the scope of the problematic parameters to a few components. Without them, is a lot harder to understand how to get terraform to work.

**Shared Files**: these reflect the presence of symlinks (or [symbolic links](https://en.wikipedia.org/wiki/Symbolic_link)) targeting a shared directory). These terraform files specify resources to be deployed onto dev and prod alike. These are:
  
- main.tf 
- outputs.tf
- providers.tf
- variables.tf

Each environment directory also contains files called `terraform.tfvars` overriding the default values specified in `varibales.tf`, wherever it is necessary. 

The only **VM configuration** working is on *minimal-prod-env*, which should become the new dev.

The fields **meant for deployment** are legacy terms associated with the initial setups, which failed to deploy. 
The future dev and mantainer of this repo should make *minimal-prod-env* the new dev and prod, virtually identical from the beginning.

Note that, when one configuration is worked on, no other configurations should be touched. This is because the state-tflock file is synced with the GCP storage bucket in the GC Project. Of course one can load different initialization scripts (`helper-scripts`) and work concurrently on different GCP projects.
